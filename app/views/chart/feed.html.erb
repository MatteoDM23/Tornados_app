<% provide(:title, "Feed") %>
<body class="feed">
    <h2>Tornadoes - Annual 2016</h2>
    <%= javascript_include_tag 'https://maps.googleapis.com/maps/api/js?key=AIzaSyBjwNwMzGpr13bzBoWDc11huaDj4zDnn9g&libraries=visualization,places', 'data-turbolinks-track': 'reload' %>
    <p>Similar to the previous four years, tornado activity across the U.S. during 2016 was below average. 
    During January-August, there were 943 confirmed tornado reports, with 142 reports still pending for September-December. 
    This brings the 2016 preliminary tornado count to 1085, with the final count expected to be lower. 
    As with most years, there were several large and destructive tornado and severe weather outbreaks during 2016.</p>
    
    <!-- chart 1: google map -->
    <h2 id="live-label">Tornadoes 2016 in USA - Heat Map <span id="result-count"></span></h2><br>
    <br>
    <div id="feedMap" style="width: 100%; height: 600px;"></div><br><br>
    
    <!-- chart 2: barchart tornadoes/state -->
    <div class="jumbotron myBackground4">
     <h2>USA tornadoes of 2016 - Report</h2>
     <p>The following chart reports the distribution of tornadoes over time in 2016 in USA with details of a total number of events per day</p>
     <%= bar_chart Tornado.group(:st).count, id: "users-chart", width: "1020px", height: "700px" %>
    </div>
    <br>
    
    <!-- chart 3: tornadoes/days per state -->
    <div class="jumbotron myBackground4">
     <h2>Single State Statictics</h2><br>
     <p>Type in the State abbreviation and obtain individual statistics</p>
     <!-- drop down menu code -->
      <div class="row">
        <div class="col-md-4 col-md-offset-4">
        <%= form_tag feed_path do |f| %>
        <%= text_field_tag :state, nil, placeholder: "Select State", class: 'form-control' %>
        <!--<%= select_tag :state, options_for_select([["Select" , "" ], ["AR", 1], ["FL", 2]]) %>-->
        <%= submit_tag "Get Statistics", class: "btn btn-primary" %>
        <% end %>
        </div>
      </div><br>
      <p>Total number of tornadoes in <b><%= @state %></b> in 2016 is: <b><%= Tornado.where(:st => @state).count %></b></p><br>
      <p>Time distribution chart</p>
      <%= line_chart Tornado.where(:st => @state).group_by_day(:date).count %>
      <p>F-scale/loss distribution chart</p>
      <%= bar_chart Tornado.where(:st => @state).group(:date).sum(:mag), id: "users-chart-2", width: "1020px", height: "700px" %>
      <br>
      
      
    </div>
    <br><br><br><br>
</body>
